<!DOCTYPE html>
<html>
    <head>
        <title>Crowding of London underground tube stations</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial scale=1"/>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

        <script>
            // When the 'View Crowding' button is clicked, the 'onButtonClick' function is called
            // This function retrieves the NaptanID of the tube station selected, as well as the day of the week.
            // The NaptanID and the day of the week is placed into the url.
            // Fetch is used to query the TFL API, which includes a header with the app_key so that the access to the API is authorised.
            const options = {
                method: 'POST',
                headers: {
                    accept: 'application/json',
                    'content-type': 'application/json',
                    authorization: 'Bearer token d8J4TmqaHyXh5H5uo2YTJHB15GrvKPLW.Cuo9pegBtQY48BpxWmMvLn8QC6k3SBb8',
                    'x-api-key': '2jqSPFo7ki5faZtPG66ys5BgNpMnNX5vaKFj1MlL'
                }
            };

            fetch('https://portal.your.md/v4/chat', options)
                .then(response => { return response.json
                   
                    })
                        // response.json())
                .then(data => console.log(data))
                .catch(err => console.error(err));

    //         // This function passes the data on to other functions to be processed and displayed.
    //         // @param data - the JSON data of the response from the API
    //         const processJson = data =>{
    //             displayPeakTimes(data)
    //             displayChartandTable(data)
    //         }

    //         // This function displays the AM and PM peak times, by retrieving amPeakTimeBand and pmPeakTimeBand from data.
    //         // @param data - the JSON data of the response from the API
    //         const displayPeakTimes = data => {
    //             document.getElementById('AMPeak').style.display = "block";
    //             document.getElementById('PMPeak').style.display = "block";
    //             document.getElementById("AMPeak").innerHTML = "AM Peak: " + data.amPeakTimeBand;
    //             document.getElementById("PMPeak").innerHTML = "PM Peak: " + data.pmPeakTimeBand;
    //         }

    //         // This function displays the bar chart and table of the crowding tube stations on a particular day.
    //         // The bar char is initially destroyed when the function is called to ensure that it displays the correct bar chart and not a previously created one.
    //         // The table is initially removed so that it displays the correct data and not the previously created one.
    //         // The timebands of the data is pushed onto the labels array.
    //         // The percentageOfBaseLine of data is multiplied by 100 to get its percentage value and pushed onto the crowding array.
    //         // These values are used for both the bar chart and table.
    //         // @param data - the JSON data of the response from the API
    //         const displayChartandTable = data => {
    //             let crowdingChart = Chart.getChart("crowdingChart")
    //             if (crowdingChart != undefined){
    //                 crowdingChart.destroy()
    //             }
                
    //             $("#crowdingTable tr").remove(); 

    //             var labels = []
    //             var crowding = []

    //             for (var tBand in data.timeBands){
    //                 labels.push(data.timeBands[tBand].timeBand)
    //                 let tempCrowding = ((data.timeBands[tBand].percentageOfBaseLine) * 100) 
    //                 crowding.push(tempCrowding.toFixed())
    //             }

    //             const tflData = { labels: labels,
    //                             datasets: [{
    //                                 label: "Crowding",
    //                                 data: crowding,
    //                             }]
    //             };

    //             const tflChart = document.getElementById('crowdingChart');
    //             Chart.defaults.scales.linear.max = 100;
    //             var crowdingBarChart = new Chart(tflChart, {
    //                 type: 'bar',
    //                 data: tflData
    //             });
    //             options: {
    //                 scales: {
    //                     y: {
    //                         beginAtZero: true
    //                         suggestedMin = 0
    //                         suggestedMax = 100
    //                     }
    //                 }
    //             }

    //             document.getElementById('crowdingTable').style.display = "block";
    //             const table = document.getElementById('crowdingTable');
    //             for (var tBand in data.timeBands){
    //                 let row = table.insertRow();
    //                 let timeBand = row.insertCell(0);
    //                 timeBand.innerHTML = labels[tBand];
    //                 let percentageValue = row.insertCell(1);
    //                 percentageValue.innerHTML = crowding[tBand]
    //             }   
    //         }
    </script>
    </head>

   
</html>